apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: supplychaindemovalidator4ibft
  namespace: supplychaindemo-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: supplychaindemovalidator4ibft
  chart:
    git: ssh://git@github.com/azoumi/blockchain-automation-framework.git
    ref: demo/besu
    path: platforms/hyperledger-besu/charts/node_validator 
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://b084c8d7be3c8e61612c91107d7eb6df6f5795cee97f23195100d705c455753baa479c51d05002cec5a4e244ba89af12749e26d92d2b429aca1e1a1b64ff1374@54.171.205.179:15050"
      - "enode://81da46b8ed96364c7ac9e96054c67379e8226289aac60272bbcba384796f210a931d23d5e04731a214fe85ef277092f970b7739ca92fce58ef80e0b13fc2ffaf@54.171.205.179:15060"
      - "enode://4b332d1254277a776cd5b825db4c99e147aa372109f087d30801b5398e9e81b718c332df95926fa3aa3c15ce26d1063826d04e2769171f309fe855b8ca1d056d@54.171.205.179:15070"
      - "enode://f6cb346ce5e707fffe99fc0dabacf465ae47eddf14144ae7e0033b3559c2ce33a0756d94bf02255c5dfe04721cfb16966197c429f0831a0c68ba449c19175742@54.171.205.179:15080"
      - "enode://6a6f76305ee047bcdaf8cf4b2d02941bad3a0242629a4f2282cb60e6909d79a5da7297a806aecad45b9a6da9dae59cc90c8deaf9cb6122d3d2b33feb8f30a577@54.171.205.179:15010"
      - "enode://81c98fcb6ccdd51e8180cd6cc5e3ef50833cda37cbfdfedf172eed86f9629e231e64dc69030bb193888fe1902843fa457821f6fc780aba0acf869bbc548de353@54.171.205.179:15020"
      - "enode://5dcbbb458b4b0b7db22e2a3450c7bc91b1f4336c6160cc9dfc87a4023cf706e3dbf884c0cb2f029b4ed29968b9e9059eedf3b2ecfd6449418bf6fe35f6356047@54.171.205.179:15030"
      - "enode://9f91954dddb82a55ec447cbd72443a64ffc7bca956194bca3780e3a1ae233063611f0dafdd6f860cd75e094ad38d7e0ac1088bcf13d6344cd6e3bd38efa2e33e@54.171.205.179:15040"

    metadata:
      namespace: supplychaindemo-bes
      labels:

    ambassador:
      external_url_suffix: bs.dev2.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false

    proxy:
      provider: ambassador
      external_url: supplychaindemo.bs.dev2.aws.blockchaincloudpoc-develop.com
      p2p: 15080
      rpc: 15081

    images:
      node: hyperledger/besu:1.4.4
      alpineutils: hyperledgerlabs/alpine-utils:1.0

    node:
      name: validator4
      tls: True
      consensus: ibft
      mountPath: /etc/genesis
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://vault.internal.dev2.aws.blockchaincloudpoc-develop.com:20001
      secretprefix: secret/supplychaindemo-bes/crypto/validator4
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besusupplychaindemo

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NGJhMDI2YTY1NTJjN2ZlYjIxNzFiMzRhMTVmNTY0MjA4ZGFhZmNmZGM5NDA3NjgxMzVlNDVkYmZlYjZkZDU3MDJhZjc1MDZiYWVlZjE0MmRlZDM5NDc3MDBhZjRkNTIwMWJiZmZhOTJjOTFjYzY4MTI4YjlkYWNmM2Q1OTY5NDNlYjRjZTVmZDZlNTMzMTNhMWM4NDVkNGU0YzM4NTU2NjQ5ZDE4ZGU4MDg0MDAwMDAwMDBjMCIKfQ==
