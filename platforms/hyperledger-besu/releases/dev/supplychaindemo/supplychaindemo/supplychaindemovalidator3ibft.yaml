apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: supplychaindemovalidator3ibft
  namespace: supplychaindemo-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: supplychaindemovalidator3ibft
  chart:
    git: ssh://git@github.com/azoumi/blockchain-automation-framework.git
    ref: demo/besu
    path: platforms/hyperledger-besu/charts/node_validator 
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://f37de42793824afe239286f4f47de6cd2287d603e5954dccce394c75284dc7b609713a3e1704125f3cc4e2628f245d3df0cf8b40f24463c9c3913db2aef70ed6@54.171.205.179:15050"
      - "enode://04a15d6082a7352306c2792f938d4fc56bb45e2ec350731fecf78f45f54f3a0051bb51d29d8ddf3162f09d6d47a68d566afc55693aa937a84a230bcb8b8863a4@54.171.205.179:15060"
      - "enode://8837c29a5f2b70a9185c1317943bede20cc9e19e993ea213ca519dcdd9e4798415e92230505f50f239343e07691bd5fb63a341bfe574b35720308dae6333bd45@54.171.205.179:15070"
      - "enode://062b6dd7a9ffdcb69968d89536bd3c6d4a7447b48ab3a772f45da481113a6b78f13ed46348be767c149c3a47370e1eb0ffc96d12589d4c75c50dcaa358c0b2a5@54.171.205.179:15080"
      - "enode://052481822a3e312e5aaa96606131db890e23d40a295a2422cd14fd077f035c1dc7065f10b32e22f73257f0a1c09277d92a1fa2dbc8eb3e5562bd00a357f795ab@54.171.205.179:15010"
      - "enode://c307912207b1ec4fdd4c6efd22edd878b17f1702fdaf471fc5f6177dfdfd6081d129eae2d86f92ffc690c275cb4e78af78f23ff02112103b691af7ca6aaf4b80@54.171.205.179:15020"
      - "enode://f94d4b3fe34fd057a750940cd7aeb6c8d0c3a244f55bab1b28daeed34fdaaa58ecce5f5ee9353b688421e77c459f7e8954029a1895801e9408a5ccd9ac963c90@54.171.205.179:15030"
      - "enode://84e0dbb7f1c993a81b88e7a547660bf7670c259927cb46dbcc208baadbff0447398541398a6ab98f7934ccc9c3dcdb3f697fcddada516a3b01176853947f23b6@54.171.205.179:15040"

    metadata:
      namespace: supplychaindemo-bes
      labels:

    ambassador:
      external_url_suffix: bs.dev2.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false

    proxy:
      provider: ambassador
      external_url: supplychaindemo.bs.dev2.aws.blockchaincloudpoc-develop.com
      p2p: 15070
      rpc: 15071

    images:
      node: hyperledger/besu:1.4.4
      alpineutils: hyperledgerlabs/alpine-utils:1.0

    node:
      name: validator3
      tls: True
      consensus: ibft
      mountPath: /etc/genesis
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://vault.internal.dev2.aws.blockchaincloudpoc-develop.com:20001
      secretprefix: secret/supplychaindemo-bes/crypto/validator3
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besusupplychaindemo

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NDIzYjdjMzdlODQ0NTdhNTM4ZWJhMzc4N2Y3ODY4NjQ4YWZlZTUwODI5NDdmM2ZlODBiMzdiOTA1N2Q3NjQxMGRjZDI4YTJjMTllNDkwMGZjMGY5NDcyZmFjZjZhZGYwZjZmNDZjZjc5MDJkNzkyZGY0YTM1ZDE4ZjFhMGU5NGQ5NDg0MGE2NzRiYmU0NDllMDM1ZDY0ZTgwZTdmMTgxODdlMWQwNjQ4MDg0MDAwMDAwMDBjMCIKfQ==
